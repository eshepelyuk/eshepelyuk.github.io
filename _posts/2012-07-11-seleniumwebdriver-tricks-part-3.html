---
layout: post
title: Selenium/WebDriver tricks - part 3
date: '2012-07-11T15:27:00.001+03:00'
author: Evgeny Shepelyuk
tags:
- java
- webdriver
- how-to
- selenium
modified_time: '2012-07-11T15:28:57.802+03:00'
blogger_id: tag:blogger.com,1999:blog-4998424779235998349.post-487879662500532611
blogger_orig_url: http://eshepelyuk.blogspot.com/2012/07/seleniumwebdriver-tricks-part-3.html
---

<span style="font-size: large;">Intro</span><br /><br />It's common case for dynamic pages to show / hide some elements basing on user's actions. But covering them with stable WebDriver tests could be sometimes cumbersome. I'll try to explain couple of techniques helping to deal with that sort of web pages. <br /><br /><span style="font-size: large;">Case #1</span><br /><br />First approach I'd like to describe is rendering all the elements on page load but set CSS <span style="font-family: &quot;Courier New&quot;, &quot;Courier&quot;, monospace;">display</span> property to <span style="font-family: &quot;Courier New&quot;, &quot;Courier&quot;, monospace;">none </span>and later set it to empty or <span style="font-family: &quot;Courier New&quot;, &quot;Courier&quot;, monospace;">block</span> to make element visible.<br /><br />In this case we can't just check visibility by using <span style="font-family: &quot;Courier New&quot;, &quot;Courier&quot;, monospace;">webDriver.findElement(...)</span> since it will return valid element but we don't know if it visible or not. Fortunately <span style="font-family: &quot;Courier New&quot;, &quot;Courier&quot;, monospace;">WebElement</span> interface has method <span style="font-family: &quot;Courier New&quot;, &quot;Courier&quot;, monospace;">isDisplayed()</span> however obvious solution <span style="font-family: &quot;Courier New&quot;, &quot;Courier&quot;, monospace;">webDriver.findElement(...).isDisplayed()</span> could be erroneous because JavaScript code that changes element visibility works with delays. To overcome such problems we can use <span style="font-family: &quot;Courier New&quot;, &quot;Courier&quot;, monospace;">WebDriverWait</span> class.<br /><pre class="brush:java">WebDriverWait webDriverWait = new WebDriverWait(webDriver, 10L);<br />WebElement visibleElement = webDriverWait.until(new Function&lt;Webdriver, WebElement&gt;() {<br /> @Override<br /> public WebElement apply(WebDriver webDriver) {<br />  WebElement we = webDriver.findElement(...);<br />  return we.isDisplayed() ? we : null;<br /> }<br />});<br /></pre><br />The code periodically finds element and checks its visibility. When element exist and visible it will be returned by <span style="font-family: &quot;Courier New&quot;, &quot;Courier&quot;, monospace;">until(..) </span>method.<br /><br />To check if element is invisible at the moment we can use similar approach just negating the condition in the function body<br /><br /><span style="font-size: large;">Case #2</span><br /><br />There's another option for dealing with show/hide certain parts of the page. Your code can create required HTML on the fly while showing and remove elements from DOM while hiding. To check element visibility we can use approach described above. But for checking if the part of the page is not shown to customer we can't use that because there's no elements in DOM and if we try to use <span style="font-family: &quot;Courier New&quot;, &quot;Courier&quot;, monospace;">findElement(...)</span> we will get the exception.<br /><br />Issue could be solved by using <span style="font-family: &quot;Courier New&quot;, &quot;Courier&quot;, monospace;">WebDriverWait </span>and <span style="font-family: &quot;Courier New&quot;, &quot;Courier&quot;, monospace;">findElements(...)</span> method that doesn't throw an exception but return empty list if no elements found. <br /><pre class="brush:java">WebDriverWait webDriverWait = new WebDriverWait(webDriver, 10L);<br />webDriverWait.until(new Predicate&lt;WebDriver&gt;() {<br /> @Override<br /> public boolean apply(WebDriver webDriver) {<br />  return webDriver.findElements(...).size() == 0;<br /> }<br />});<br /></pre><br />Code periodically searches for elements matching criteria and return true when no elements found. <br /><br /><span style="font-size: large;">P.S.</span><br /><br />It could save your time and make your code cleaner if you put code samples from above as static methods into utility class.  This allows you to easily reuse such functionality while writing WebDriver tests for your pages.